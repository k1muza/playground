
{
  "entities": {
    "Course": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Course",
      "type": "object",
      "description": "Represents a course offered on the platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the course."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the course."
        },
        "title": {
          "type": "string",
          "description": "Title of the course."
        },
        "description": {
          "type": "string",
          "description": "Description of the course."
        },
        "level": {
          "type": "string",
          "description": "Difficulty level of the course (e.g., Beginner, Intermediate, Advanced)."
        },
        "topicIds": {
          "type": "array",
          "description": "References to Topics. (Relationship: Course 1:N Topic)",
          "items": {
            "type": "string"
          }
        },
        "lessonIds": {
          "type": "array",
          "description": "References to Lessons. (Relationship: Course 1:N Lesson)",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "slug",
        "title",
        "description",
        "level"
      ]
    },
    "Lesson": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Lesson",
      "type": "object",
      "description": "Represents a lesson within a course.",
      "properties": {
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the lesson, used as document ID."
        },
        "title": {
          "type": "string",
          "description": "Title of the lesson."
        },
        "excerpt": {
          "type": "string",
          "description": "A short summary of the lesson."
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for categorizing the lesson."
        },
        "body": {
          "type": "string",
          "description": "Content of the lesson (e.g., Markdown or HTML)."
        }
      },
      "required": [
        "slug",
        "title",
        "excerpt",
        "tags",
        "body"
      ]
    },
    "Problem": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Problem",
      "type": "object",
      "description": "Represents a practice problem. Test cases are stored in a subcollection.",
      "properties": {
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the problem, used as document ID."
        },
        "title": {
          "type": "string",
          "description": "Title of the problem."
        },
        "summary": {
          "type": "string",
          "description": "Brief summary of the problem."
        },
        "difficulty": {
          "type": "string",
          "description": "Difficulty level of the problem (e.g., Easy, Medium, Hard)."
        },
        "tags": {
          "type": "array",
          "description": "Array of string tags for categorization.",
          "items": {
            "type": "string"
          }
        },
        "body": {
          "type": "string",
          "description": "Full problem statement."
        },
        "templateCode": {
          "type": "string",
          "description": "Boilerplate code for the user to start with."
        }
      },
      "required": [
        "slug",
        "title",
        "summary",
        "difficulty",
        "tags",
        "body",
        "templateCode"
      ]
    },
    "TestCase": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Test Case",
      "type": "object",
      "description": "Represents a single test case for a problem.",
      "properties": {
        "problemId": {
          "type": "string",
          "description": "The slug of the problem this test case belongs to."
        },
        "input": {
          "type": "string",
          "description": "JSON string representing the arguments for the solution function."
        },
        "output": {
          "type": "string",
          "description": "JSON string representing the expected return value."
        }
      },
      "required": [
        "problemId",
        "input",
        "output"
      ]
    },
    "Article": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Article",
      "type": "object",
      "description": "Represents an article.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the article."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the article."
        },
        "title": {
          "type": "string",
          "description": "Title of the article."
        },
        "excerpt": {
          "type": "string",
          "description": "Short excerpt of the article."
        },
        "tagIds": {
          "type": "array",
          "description": "References to Tags. (Relationship: Article N:N Tag)",
          "items": {
            "type": "string"
          }
        },
        "body": {
          "type": "string",
          "description": "Full content of the article."
        }
      },
      "required": [
        "id",
        "slug",
        "title",
        "excerpt",
        "body"
      ]
    },
    "Tag": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Tag",
      "type": "object",
      "description": "Represents a tag for categorizing content.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the tag."
        },
        "label": {
          "type": "string",
          "description": "Display name of the tag."
        }
      },
      "required": [
        "id",
        "label"
      ]
    },
    "Topic": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Topic",
      "type": "object",
      "description": "Represents a topic within a course.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the topic."
        },
        "label": {
          "type": "string",
          "description": "Display name of the topic."
        }
      },
      "required": [
        "id",
        "label"
      ]
    },
    "Submission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Submission",
      "type": "object",
      "description": "Represents a user's submission to a specific problem.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the submission."
        },
        "problemId": {
          "type": "string",
          "description": "Reference to Problem. (Relationship: Problem 1:N Submission)"
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Submission)"
        },
        "code": {
          "type": "string",
          "description": "The code the user submitted as a solution."
        },
        "submittedAt": {
          "type": "string",
          "description": "The date and time the solution was submitted.",
          "format": "date-time"
        },
        "isCorrect": {
          "type": "boolean",
          "description": "Indicates whether the solution is correct or not."
        },
        "aiSuggestion": {
          "type": "string",
          "description": "An AI-generated suggestion for improving the code."
        }
      },
      "required": [
        "id",
        "problemId",
        "userId",
        "code",
        "submittedAt",
        "isCorrect"
      ]
    },
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the platform.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "Display name of the user."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "courses/{courseId}",
        "definition": {
          "entityName": "Course",
          "schema": {
            "$ref": "#/backend/entities/Course"
          },
          "description": "Stores course information.",
          "params": [
            {
              "name": "courseId",
              "description": "Unique identifier for the course."
            }
          ]
        }
      },
      {
        "path": "lessons/{lessonSlug}",
        "definition": {
          "entityName": "Lesson",
          "schema": {
            "$ref": "#/backend/entities/Lesson"
          },
          "description": "Stores lesson information.",
          "params": [
            {
              "name": "lessonSlug",
              "description": "URL-friendly slug for the lesson, used as document ID."
            }
          ]
        }
      },
      {
        "path": "problems/{problemSlug}",
        "definition": {
          "entityName": "Problem",
          "schema": {
            "$ref": "#/backend/entities/Problem"
          },
          "description": "Stores problem information, using the URL slug as the document ID.",
          "params": [
            {
              "name": "problemSlug",
              "description": "URL-friendly slug for the problem, which is also the document ID."
            }
          ]
        }
      },
      {
        "path": "problems/{problemSlug}/testCases/{testCaseId}",
        "definition": {
          "entityName": "TestCase",
          "schema": {
            "$ref": "#/backend/entities/TestCase"
          },
          "description": "Stores test cases for a specific problem.",
          "params": [
            {
              "name": "problemSlug",
              "description": "The slug of the associated problem."
            },
            {
              "name": "testCaseId",
              "description": "Unique identifier for the test case."
            }
          ]
        }
      },
      {
        "path": "problems/{problemSlug}/submissions/{submissionId}",
        "definition": {
          "entityName": "Submission",
          "schema": {
            "$ref": "#/backend/entities/Submission"
          },
          "description": "Stores submissions for a specific problem. Includes denormalized `userId` and `problemId` for authorization independence and efficient querying.",
          "params": [
            {
              "name": "problemSlug",
              "description": "The slug of the associated problem."
            },
            {
              "name": "submissionId",
              "description": "Unique identifier for the submission."
            }
          ]
        }
      },
      {
        "path": "articles/{articleId}",
        "definition": {
          "entityName": "Article",
          "schema": {
            "$ref": "#/backend/entities/Article"
          },
          "description": "Stores article information.",
          "params": [
            {
              "name": "articleId",
              "description": "Unique identifier for the article."
            }
          ]
        }
      },
      {
        "path": "tags/{tagId}",
        "definition": {
          "entityName": "Tag",
          "schema": {
            "$ref": "#/backend/entities/Tag"
          },
          "description": "Stores tag information.",
          "params": [
            {
              "name": "tagId",
              "description": "Unique identifier for the tag."
            }
          ]
        }
      },
      {
        "path": "topics/{topicId}",
        "definition": {
          "entityName": "Topic",
          "schema": {
            "$ref": "#/backend/entities/Topic"
          },
          "description": "Stores topic information.",
          "params": [
            {
              "name": "topicId",
              "description": "Unique identifier for the topic."
            }
          ]
        }
      },
      {
        "path": "users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user information.",
          "params": [
            {
              "name": "userId",
              "description": "Unique identifier for the user."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to reflect the relationships between courses, lessons, problems, articles, tags, and user submissions. For problems and lessons, the document ID is the URL slug for direct and efficient lookups. Test cases and submissions are stored in subcollections under each problem for scalability and to keep the main problem document lean. This structure supports secure list operations (QAPs) by ensuring all documents in the `problems/{problemSlug}/submissions` collection share the same security context. Denormalization is used for submissions, which include the `userId` and `problemId` to allow for efficient cross-problem queries (e.g., 'show me all problems a user has solved') using collection group queries on the `submissions` collection."
  }
}
    